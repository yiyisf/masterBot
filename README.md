# CMaster Bot - ä¼ä¸šçº§ AI åŠ©æ‰‹

ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡ã€å¯æ‰©å±•çš„ä¼ä¸šçº§ AI åŠ©æ‰‹ç³»ç»Ÿï¼Œé›†æˆäº†ç°ä»£åŒ–çš„ Web æ§åˆ¶å°ã€å¯çƒ­åŠ è½½çš„ LLM å¼•æ“ä»¥åŠå¼ºå¤§çš„æ’ä»¶ç³»ç»Ÿã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- ğŸ–¥ï¸ **ç°ä»£åŒ– Web æ§åˆ¶å°** - åŸºäº Next.js 16 + shadcn/ui æ„å»ºï¼Œæä¾›ä»ªè¡¨ç›˜ã€èŠå¤©ã€æŠ€èƒ½ç®¡ç†ç­‰å…¨æ–¹ä½ç•Œé¢ã€‚
- ğŸ¤– **å¤š LLM é€‚é…** - åŒæ—¶æ”¯æŒ OpenAI å’Œ Anthropic API æ ‡å‡†ï¼Œæ”¯æŒæ¨¡å‹çƒ­åŠ è½½ã€‚
- ğŸ”§ **å¯æ‰©å±•æŠ€èƒ½ç³»ç»Ÿ** - åŸºäº `SKILL.md` åè®® + MCP åè®®ï¼Œæ”¯æŒ Shell æ‰§è¡Œã€æ–‡ä»¶ç®¡ç†ã€HTTP è¯·æ±‚åŠç¤¾åŒºå·¥å…·æ¥å…¥ã€‚
- ğŸ§  **åŒå±‚è®°å¿†ç³»ç»Ÿ** - çŸ­æœŸä¼šè¯è®°å¿†ï¼ˆLRU æ·˜æ±°ï¼‰+ é•¿æœŸè®°å¿†ï¼ˆSQLite å‘é‡ä½™å¼¦æ£€ç´¢ï¼‰ï¼Œè·¨ä¼šè¯çŸ¥è¯†æŒä¹…åŒ–ã€‚
- ğŸ“‹ **Task DAG ä»»åŠ¡ç¼–æ’** - Agent å¯å°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºæœ‰å‘æ— ç¯å›¾ï¼Œæ”¯æŒä¾èµ–å£°æ˜å’Œå°±ç»ªä»»åŠ¡å¹¶è¡Œæ‰§è¡Œã€‚
- ğŸ”’ **å®‰å…¨åŠ å›º** - Shell å‘½ä»¤æ²™ç®±ï¼ˆé»‘åå•/ç™½åå•ï¼‰+ è®¤è¯ä¸­é—´ä»¶ï¼ˆAPI Key / JWTï¼‰ã€‚
- ğŸªŸ **ä¸Šä¸‹æ–‡çª—å£ç®¡ç†** - æ»‘åŠ¨çª—å£ + LLM æ‘˜è¦å‹ç¼©ï¼Œé˜²æ­¢è¶…å‡ºæ¨¡å‹ä¸Šä¸‹æ–‡é™åˆ¶ã€‚
- ğŸŒ“ **ä¸ªæ€§åŒ–ä½“éªŒ** - å…¨å±€æ”¯æŒäº®è‰²/æš—è‰²æ¨¡å¼åˆ‡æ¢ï¼Œé€‚é…å„ç§åŠå…¬ç¯å¢ƒã€‚
- ğŸ¢ **ä¼ä¸šçº§è‡ªæ‰˜ç®¡** - æ”¯æŒå†…ç½‘éš”ç¦»éƒ¨ç½²ï¼Œæ‰€æœ‰èµ„æºæœ¬åœ°åŒ–ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
# å®‰è£…æœåŠ¡ç«¯ä¾èµ–
npm install

# å®‰è£… Web UI ä¾èµ–
cd web && npm install && cd ..
```

### é…ç½®

1. å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š
```bash
cp .env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä½ çš„ LLM æœåŠ¡åœ°å€å’Œå¯†é’¥ï¼š
```env
OPENAI_BASE_URL=http://your-internal-ai-gateway/v1
OPENAI_API_KEY=your-api-key
OPENAI_MODEL=gpt-4
```

### å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘æ¨¡å¼ (æœåŠ¡ç«¯)
npm run dev

# åªæœ‰åœ¨éœ€è¦ä¿®æ”¹ UI æ—¶æ‰§è¡Œ (Web ç«¯)
cd web && npm run dev

# ç”Ÿäº§éƒ¨ç½² (æ„å»ºå¹¶ç”±æœåŠ¡ç«¯æ‰˜ç®¡)
npm run build          # æ„å»ºåç«¯
cd web && npm run build # æ„å»ºå‰ç«¯
cd ..
npm start              # å¯åŠ¨ç»Ÿä¸€æœåŠ¡
```

## ğŸ–¥ï¸ Web æ§åˆ¶å°

é¡¹ç›®é›†æˆäº†åŸºäº Next.js çš„ç°ä»£åŒ–ç®¡ç†åå°ï¼Œé»˜è®¤è®¿é—®åœ°å€ä¸º `http://localhost:3000`ã€‚

- **ä»ªè¡¨ç›˜**ï¼šæŸ¥çœ‹ç³»ç»Ÿæ¦‚è§ˆã€‚
- **æ™ºèƒ½å¯¹è¯**ï¼šä½“éªŒ ReAct å¢å¼ºçš„ AI äº¤äº’ï¼Œæ”¯æŒä¸»é¢˜åˆ‡æ¢ã€‚
- **æŠ€èƒ½ç®¡ç†**ï¼šå®æ—¶æŸ¥çœ‹åç«¯åŠ è½½çš„æ‰©å±•æ’ä»¶ã€‚

## API ä½¿ç”¨

### è®¤è¯

é»˜è®¤å…³é—­è®¤è¯ã€‚å¯ç”¨åæ”¯æŒä¸¤ç§æ¨¡å¼ï¼š

```bash
# API Key æ¨¡å¼
curl -X POST http://localhost:3000/api/chat \
  -H "X-API-Key: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{"message": "ä½ å¥½"}'

# JWT æ¨¡å¼
curl -X POST http://localhost:3000/api/chat \
  -H "Authorization: Bearer <jwt-token>" \
  -H "Content-Type: application/json" \
  -d '{"message": "ä½ å¥½"}'
```

é€šè¿‡ `config/default.yaml` æˆ–ç¯å¢ƒå˜é‡é…ç½®è®¤è¯ï¼š
```yaml
auth:
  enabled: true
  mode: api-key        # api-key æˆ– jwt
  apiKeys: [your-key]
  jwtSecret: your-secret
```

### èŠå¤© API

```bash
# å•æ¬¡å¯¹è¯
curl -X POST http://localhost:3000/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "å¸®æˆ‘åˆ—å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶"}'

# æµå¼å“åº”
curl -X POST http://localhost:3000/api/chat/stream \
  -H "Content-Type: application/json" \
  -d '{"message": "å†™ä¸€ä¸ª Hello World ç¨‹åº"}'
```

### MCP æœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹å·²é…ç½®çš„ MCP æœåŠ¡
curl http://localhost:3000/api/mcp/config

# æ·»åŠ  MCP æœåŠ¡
curl -X POST http://localhost:3000/api/mcp/config \
  -H "Content-Type: application/json" \
  -d '{"name": "my-mcp", "type": "stdio", "command": "npx", "args": ["-y", "some-mcp-server"], "enabled": true}'
```

### WebSocket

```javascript
const ws = new WebSocket('ws://localhost:3000/ws');
ws.send(JSON.stringify({ type: 'chat', message: 'ä½ å¥½' }));
```

## æŠ€èƒ½ç³»ç»Ÿ

æŠ€èƒ½æ˜¯æ‰©å±• AI åŠ©æ‰‹èƒ½åŠ›çš„æ¨¡å—ã€‚æ¯ä¸ªæŠ€èƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹ç›®å½•ï¼ŒåŒ…å« `SKILL.md` æè¿°æ–‡ä»¶ã€‚

### ç›®å½•ç»“æ„

```
skills/
â”œâ”€â”€ built-in/         # å†…ç½®æŠ€èƒ½
â”‚   â”œâ”€â”€ shell/
â”‚   â”œâ”€â”€ file-manager/
â”‚   â””â”€â”€ http-client/
â”œâ”€â”€ installed/        # å®‰è£…çš„ç¬¬ä¸‰æ–¹æŠ€èƒ½
â””â”€â”€ local/            # æœ¬åœ°å¼€å‘çš„æŠ€èƒ½
```

### åˆ›å»ºæ–°æŠ€èƒ½

1. åœ¨ `skills/local/` ä¸‹åˆ›å»ºæŠ€èƒ½ç›®å½•
2. åˆ›å»º `SKILL.md` æ–‡ä»¶å®šä¹‰æŠ€èƒ½å…ƒæ•°æ®å’Œ actions
3. åˆ›å»º `index.ts` å®ç° action å¤„ç†å‡½æ•°

ç¤ºä¾‹ `SKILL.md`:

```yaml
---
name: my-skill
version: 1.0.0
description: æˆ‘çš„è‡ªå®šä¹‰æŠ€èƒ½
---

# My Skill

## Actions

### do_something
æ‰§è¡ŒæŸä¸ªæ“ä½œ
- **å‚æ•°**: `input` (string) - è¾“å…¥å†…å®¹
- **è¿”å›**: æ“ä½œç»“æœ
```

## æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Gateway Layer                 â”‚
â”‚  (Fastify HTTP/WS/SSE + Auth Middleware) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            Agent Core                    â”‚
â”‚  (ReAct + Think-Plan-Act + Task DAG)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Memory System  â”‚    Skill System        â”‚
â”‚  Short-term LRU â”‚  Local (SKILL.md)      â”‚
â”‚  Long-term Vec  â”‚  MCP (stdio/SSE)       â”‚
â”‚  Context Mgr    â”‚  Shell Sandbox         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         LLM Adapter Layer                â”‚
â”‚   (OpenAI / Anthropic / Custom)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         SQLite (WAL mode)                â”‚
â”‚  sessions | messages | tasks | memories  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## License

MIT
